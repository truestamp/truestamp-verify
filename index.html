<!DOCTYPE html><html class="default"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>@truestamp/verify - v0.2.0</title><meta name="description" content="Documentation for @truestamp/verify - v0.2.0"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script async src="assets/search.js" id="search-script"></script></head><body><script>document.body.classList.add(localStorage.getItem("tsd-theme") || "os")</script><header><div class="tsd-page-toolbar"><div class="container"><div class="table-wrap"><div class="table-cell" id="tsd-search" data-base="."><div class="field"><label for="tsd-search-field" class="tsd-widget search no-caption">Search</label><input type="text" id="tsd-search-field"/></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="https://github.com/truestamp/truestamp-verify" class="title">github.com/truestamp/truestamp-verify</a></div><div class="table-cell" id="tsd-widgets"><div id="tsd-filter"><a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a><div class="tsd-filter-group"><div class="tsd-select" id="tsd-filter-visibility"><span class="tsd-select-label">All</span><ul class="tsd-select-list"><li data-value="public">Public</li><li data-value="protected">Public/Protected</li><li data-value="private" class="selected">All</li></ul></div> <input type="checkbox" id="tsd-filter-inherited" checked/><label class="tsd-widget" for="tsd-filter-inherited">Inherited</label><input type="checkbox" id="tsd-filter-externals" checked/><label class="tsd-widget" for="tsd-filter-externals">Externals</label></div></div><a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a></div></div></div></div><div class="tsd-page-title"><div class="container"><h1>@truestamp/verify - v0.2.0 </h1></div></div></header><div class="container container-main"><div class="row"><div class="col-8 col-content"><div class="tsd-panel tsd-typography">
<a href="#truestampverify" id="truestampverify" style="color: inherit; text-decoration: none;">
  <h1>@truestamp/verify</h1>
</a>
<p>This library provides a TypeScript/JavaScript API for verifying <a href="https://www.truestamp.com">Truestamp</a> Commitments.</p>
<p>This library provides a thorough cryptographic verification of Truestamp Commitments. Ideally, this verification is independent of, and without reliance on,
Truestamp services or APIs. This library has no external dependencies.</p>
<p>This independence helps provides users with the confidence that their Commitments are verifiable for the long term. The code for this verification is intended
to be simple to audit so as to provide confidence in its functionality and security.</p>
<p>The verification of the cryptographic integrity of the Commitment is <strong>always</strong> performed locally and requires no access to the Internet. There are requests
made to external services for the purpose of comparing locally calculated results to the values expected to be stored on-chain and to determine the timestamp
that a commitment attests to.</p>
<p>If an array of signed public keys is provided as an argument to the various verification functions, as can be found on the server
<a href="https://keys.truestamp.com">https://keys.truestamp.com</a>, they will be used and no connections to a key server will be attempted.</p>
<p>When <code>verify()</code> is called, an object will be returned that provides details of the status of each verification performed on a commitment as well as an <code>ok</code>
property to indicated success or failure.</p>
<p>Alternatively, there are functions that will only return a boolean, or throw an <code>Error</code> if there is any verification failure.</p>

<a href="#about-commitments" id="about-commitments" style="color: inherit; text-decoration: none;">
  <h2>About Commitments</h2>
</a>
<p>A Truestamp Commitment is the cryptographic &quot;glue&quot; that binds your original data, and additional metadata, to one or more public blockchains.</p>
<p>You&#39;ll note that commitments do not attest to the &quot;answer&quot; to a question. They are more analogous to the left side of a math equation. All of the elements are
there to do the math and calculate an answer, and this calculated answer is then compared to what is found on the blockchain. The &quot;math&quot; is check along the way
to ensure that a series of equations generate consistent results.</p>
<p>If the verification of the Commitment is a match to what is found on the blockchain, we can be certain of the integrity of the data reflected in the Commitment.</p>
<p>Once this verification of integrity is confirmed, the timestamp of the data can then be extracted from the blockchain block the data was committed to.</p>
<p>If any part of the equation fails, or if the data was changed by even a single bit, then the Commitment will fail to be fully processed and return an error, or
the expected data will not be found actually committed to the blockchain. In this case the commitment is considered invalid and the output of the verification
functions will reflect that.</p>

<a href="#install" id="install" style="color: inherit; text-decoration: none;">
  <h2>Install</h2>
</a>
<pre><code class="language-sh"><span class="hl-0">npm install @truestamp/verify</span>
</code></pre>

<a href="#sample-usage" id="sample-usage" style="color: inherit; text-decoration: none;">
  <h2>Sample Usage</h2>
</a>
<p>Node.js:</p>
<pre><code class="language-javascript"><span class="hl-1">// Node.js Require</span><br/><span class="hl-2">const</span><span class="hl-0"> { </span><span class="hl-3">assertVerified</span><span class="hl-0">, </span><span class="hl-3">isVerified</span><span class="hl-0">, </span><span class="hl-3">verify</span><span class="hl-0"> } = </span><span class="hl-4">require</span><span class="hl-0">(</span><span class="hl-5">&#39;@truestamp/verify&#39;</span><span class="hl-0">)</span><br/><br/><span class="hl-1">// ES Modules Import</span><br/><span class="hl-1">// import { assertVerified, isVerified, verify } from &#39;@truestamp/verify&#39;;</span><br/><br/><span class="hl-1">// Substitute with a Truestamp commitment object to be verified.</span><br/><span class="hl-2">const</span><span class="hl-0"> </span><span class="hl-3">commitment</span><span class="hl-0"> = {...}</span><br/><br/><span class="hl-1">// Returns a Promise that resolves to an object that details commitment</span><br/><span class="hl-1">// properties and a summary of what this commitment attests to.</span><br/><span class="hl-1">// It also provides pointers to the web URL&#39;s (e.g. blockchain explorer API)</span><br/><span class="hl-1">// that were used to verify transactions and where commitments can be</span><br/><span class="hl-1">// manually verified by comparing a hash with your own eyes.</span><br/><span class="hl-6">console</span><span class="hl-0">.</span><span class="hl-4">log</span><span class="hl-0">(</span><span class="hl-5">&#39;verify&#39;</span><span class="hl-0">, </span><span class="hl-7">await</span><span class="hl-0"> </span><span class="hl-4">verify</span><span class="hl-0">(</span><span class="hl-6">commitment</span><span class="hl-0">))</span><br/><br/><span class="hl-1">// Resolves to boolean `true` or `false` and will not throw Errors</span><br/><span class="hl-7">if</span><span class="hl-0"> (</span><span class="hl-7">await</span><span class="hl-0"> </span><span class="hl-4">isVerified</span><span class="hl-0">(</span><span class="hl-6">commitment</span><span class="hl-0">)) {</span><br/><span class="hl-0">  </span><span class="hl-6">console</span><span class="hl-0">.</span><span class="hl-4">log</span><span class="hl-0">(</span><span class="hl-5">&#39;verified&#39;</span><span class="hl-0">)</span><br/><span class="hl-0">} </span><span class="hl-7">else</span><span class="hl-0"> {</span><br/><span class="hl-0">  </span><span class="hl-6">console</span><span class="hl-0">.</span><span class="hl-4">log</span><span class="hl-0">(</span><span class="hl-5">&#39;bad commitment&#39;</span><span class="hl-0">)</span><br/><span class="hl-0">}</span><br/><br/><span class="hl-1">// Throws an Error on commitment validation issue,</span><br/><span class="hl-1">// or external service verification failure. Resolves</span><br/><span class="hl-1">// to `void` (returns nothing) if verified OK.</span><br/><span class="hl-7">await</span><span class="hl-0"> </span><span class="hl-4">assertVerified</span><span class="hl-0">(</span><span class="hl-6">commitment</span><span class="hl-0">)</span>
</code></pre>
<p>A more detailed version of this example can be found in [examples/example.cjs].</p>

<a href="#sample-json-verifier-output" id="sample-json-verifier-output" style="color: inherit; text-decoration: none;">
  <h2>Sample JSON Verifier Output</h2>
</a>
<p>The <code>ok</code> property will be set to true if the entirety of the Commitment is valid.</p>
<p>If there are errors they will be reflected in the verifier output <code>error</code> property and <code>ok</code> will be <code>false</code>.</p>
<p>The <code>commitsTo</code> property contains values that are verifiable and are derived from
the successful verification of a Commitment.</p>
<ul>
<li><code>submittedAfter</code> : A timestamp retrieved from Observable Entropy that your Item must have been submitted after.</li>
<li><code>submittedAt</code> : A timestamp that was embedded in the Truestamp Id, representing the time we recorded submission via the API.</li>
<li><code>submittedBefore</code> : The earliest timestamp that Commitment <code>transactions</code> are verified against. This is retrieved from on-chain block/ledger data.</li>
<li><code>submitWindowMilliseconds</code> : The time difference, in milliseconds, between <code>submittedAfter</code> and <code>submittedBefore</code>.</li>
</ul>
<pre><code class="language-json"><span class="hl-0">{</span><br/><span class="hl-0">  </span><span class="hl-8">&quot;id&quot;</span><span class="hl-0">: </span><span class="hl-5">&quot;T11_01G6ND2ZAP3QQWJGM4AGTRCQ9P_1656428265850000_0D6F6F7057B6C0AEF63D043A5AB0FF79&quot;</span><span class="hl-0">,</span><br/><span class="hl-0">  </span><span class="hl-8">&quot;success&quot;</span><span class="hl-0">: </span><span class="hl-2">true</span><span class="hl-0">,</span><br/><span class="hl-0">  </span><span class="hl-8">&quot;offline&quot;</span><span class="hl-0">: </span><span class="hl-2">false</span><span class="hl-0">,</span><br/><span class="hl-0">  </span><span class="hl-8">&quot;testnet&quot;</span><span class="hl-0">: </span><span class="hl-2">true</span><span class="hl-0">,</span><br/><span class="hl-0">  </span><span class="hl-8">&quot;itemData&quot;</span><span class="hl-0">: {</span><br/><span class="hl-0">    </span><span class="hl-8">&quot;hash&quot;</span><span class="hl-0">: </span><span class="hl-5">&quot;c15fbfedf73881e7264ccefbabdcb679d247348e35dea14eba1d906c174c3e8e&quot;</span><span class="hl-0">,</span><br/><span class="hl-0">    </span><span class="hl-8">&quot;signaturesCount&quot;</span><span class="hl-0">: </span><span class="hl-9">1</span><span class="hl-0">,</span><br/><span class="hl-0">    </span><span class="hl-8">&quot;signaturesVerified&quot;</span><span class="hl-0">: </span><span class="hl-2">true</span><br/><span class="hl-0">  },</span><br/><span class="hl-0">  </span><span class="hl-8">&quot;item&quot;</span><span class="hl-0">: {</span><br/><span class="hl-0">    </span><span class="hl-8">&quot;hash&quot;</span><span class="hl-0">: </span><span class="hl-5">&quot;6c624010de9050296f78daf1865eea20cf1e787d8cf9c81fdf43a3e70ce2ae20&quot;</span><br/><span class="hl-0">  },</span><br/><span class="hl-0">  </span><span class="hl-8">&quot;commitmentData&quot;</span><span class="hl-0">: {</span><br/><span class="hl-0">    </span><span class="hl-8">&quot;hash&quot;</span><span class="hl-0">: </span><span class="hl-5">&quot;813a5342ae5bafcc10ce375a9de87eabe70a310db5c5dede18ad93a98984c256&quot;</span><span class="hl-0">,</span><br/><span class="hl-0">    </span><span class="hl-8">&quot;signaturesCount&quot;</span><span class="hl-0">: </span><span class="hl-9">1</span><span class="hl-0">,</span><br/><span class="hl-0">    </span><span class="hl-8">&quot;signaturesVerified&quot;</span><span class="hl-0">: </span><span class="hl-2">true</span><span class="hl-0">,</span><br/><span class="hl-0">    </span><span class="hl-8">&quot;signaturesPublicKeyVerified&quot;</span><span class="hl-0">: </span><span class="hl-2">true</span><br/><span class="hl-0">  },</span><br/><span class="hl-0">  </span><span class="hl-8">&quot;proofs&quot;</span><span class="hl-0">: [</span><br/><span class="hl-0">    {</span><br/><span class="hl-0">      </span><span class="hl-8">&quot;ok&quot;</span><span class="hl-0">: </span><span class="hl-2">true</span><span class="hl-0">,</span><br/><span class="hl-0">      </span><span class="hl-8">&quot;inputHash&quot;</span><span class="hl-0">: </span><span class="hl-5">&quot;6c624010de9050296f78daf1865eea20cf1e787d8cf9c81fdf43a3e70ce2ae20&quot;</span><span class="hl-0">,</span><br/><span class="hl-0">      </span><span class="hl-8">&quot;merkleRoot&quot;</span><span class="hl-0">: </span><span class="hl-5">&quot;4ac380cda4821b1e5fb2c5ce6e7ae19ff1a8ee11b828061ab25ddc49e1ef24f5&quot;</span><br/><span class="hl-0">    },</span><br/><span class="hl-0">    {</span><br/><span class="hl-0">      </span><span class="hl-8">&quot;ok&quot;</span><span class="hl-0">: </span><span class="hl-2">true</span><span class="hl-0">,</span><br/><span class="hl-0">      </span><span class="hl-8">&quot;inputHash&quot;</span><span class="hl-0">: </span><span class="hl-5">&quot;4ac380cda4821b1e5fb2c5ce6e7ae19ff1a8ee11b828061ab25ddc49e1ef24f5&quot;</span><span class="hl-0">,</span><br/><span class="hl-0">      </span><span class="hl-8">&quot;merkleRoot&quot;</span><span class="hl-0">: </span><span class="hl-5">&quot;b4fe024ab042302b02763fcd0ebe8b12e8394c623bf8d2565b931c0e44d21f26&quot;</span><br/><span class="hl-0">    }</span><br/><span class="hl-0">  ],</span><br/><span class="hl-0">  </span><span class="hl-8">&quot;transactions&quot;</span><span class="hl-0">: [</span><br/><span class="hl-0">    {</span><br/><span class="hl-0">      </span><span class="hl-8">&quot;intent&quot;</span><span class="hl-0">: </span><span class="hl-5">&quot;stellar&quot;</span><span class="hl-0">,</span><br/><span class="hl-0">      </span><span class="hl-8">&quot;success&quot;</span><span class="hl-0">: </span><span class="hl-2">true</span><span class="hl-0">,</span><br/><span class="hl-0">      </span><span class="hl-8">&quot;offline&quot;</span><span class="hl-0">: </span><span class="hl-2">false</span><span class="hl-0">,</span><br/><span class="hl-0">      </span><span class="hl-8">&quot;transaction&quot;</span><span class="hl-0">: {</span><br/><span class="hl-0">        </span><span class="hl-8">&quot;inputHash&quot;</span><span class="hl-0">: </span><span class="hl-5">&quot;4ac380cda4821b1e5fb2c5ce6e7ae19ff1a8ee11b828061ab25ddc49e1ef24f5&quot;</span><span class="hl-0">,</span><br/><span class="hl-0">        </span><span class="hl-8">&quot;intent&quot;</span><span class="hl-0">: </span><span class="hl-5">&quot;stellar&quot;</span><span class="hl-0">,</span><br/><span class="hl-0">        </span><span class="hl-8">&quot;hash&quot;</span><span class="hl-0">: </span><span class="hl-5">&quot;50e43c22fc2274d72fb82e74a24eac50de33d71060deb75d50a6b56ab6c258db&quot;</span><span class="hl-0">,</span><br/><span class="hl-0">        </span><span class="hl-8">&quot;ledger&quot;</span><span class="hl-0">: </span><span class="hl-9">101654</span><br/><span class="hl-0">      },</span><br/><span class="hl-0">      </span><span class="hl-8">&quot;timestamp&quot;</span><span class="hl-0">: </span><span class="hl-5">&quot;2022-06-28T14:59:07Z&quot;</span><span class="hl-0">,</span><br/><span class="hl-0">      </span><span class="hl-8">&quot;urls&quot;</span><span class="hl-0">: [</span><br/><span class="hl-0">        </span><span class="hl-5">&quot;https://horizon-testnet.stellar.org/transactions/50e43c22fc2274d72fb82e74a24eac50de33d71060deb75d50a6b56ab6c258db&quot;</span><span class="hl-0">,</span><br/><span class="hl-0">        </span><span class="hl-5">&quot;https://stellar.expert/explorer/testnet/tx/50e43c22fc2274d72fb82e74a24eac50de33d71060deb75d50a6b56ab6c258db&quot;</span><br/><span class="hl-0">      ]</span><br/><span class="hl-0">    }</span><br/><span class="hl-0">  ],</span><br/><span class="hl-0">  </span><span class="hl-8">&quot;commitsTo&quot;</span><span class="hl-0">: {</span><br/><span class="hl-0">    </span><span class="hl-8">&quot;hashes&quot;</span><span class="hl-0">: [</span><br/><span class="hl-0">      </span><span class="hl-5">&quot;d54db6e2435ddbeee76ba718c438558afeb0fe718ca1ab3cd7e4f00be37eff42&quot;</span><br/><span class="hl-0">    ],</span><br/><span class="hl-0">    </span><span class="hl-8">&quot;observableEntropy&quot;</span><span class="hl-0">: </span><span class="hl-5">&quot;8e5d4171458c69d5bc812f6dee6d9335cc73331c45d3b5fb7bb33e0912af5003&quot;</span><span class="hl-0">,</span><br/><span class="hl-0">    </span><span class="hl-8">&quot;timestamps&quot;</span><span class="hl-0">: {</span><br/><span class="hl-0">      </span><span class="hl-8">&quot;submittedAfter&quot;</span><span class="hl-0">: </span><span class="hl-5">&quot;2022-06-28T14:55:23.763Z&quot;</span><span class="hl-0">,</span><br/><span class="hl-0">      </span><span class="hl-8">&quot;submittedAt&quot;</span><span class="hl-0">: </span><span class="hl-5">&quot;2022-06-28T14:57:45.850Z&quot;</span><span class="hl-0">,</span><br/><span class="hl-0">      </span><span class="hl-8">&quot;submittedBefore&quot;</span><span class="hl-0">: </span><span class="hl-5">&quot;2022-06-28T14:59:07Z&quot;</span><span class="hl-0">,</span><br/><span class="hl-0">      </span><span class="hl-8">&quot;submitWindowMilliseconds&quot;</span><span class="hl-0">: </span><span class="hl-9">223237</span><br/><span class="hl-0">    }</span><br/><span class="hl-0">  }</span><br/><span class="hl-0">}</span>
</code></pre>

<a href="#api-documentation" id="api-documentation" style="color: inherit; text-decoration: none;">
  <h2>API Documentation</h2>
</a>
<p>The <a href="https://truestamp.github.io/truestamp-verify/">TypeScript API documentation</a> for this project is generated and published upon each new release.</p>

<a href="#testing" id="testing" style="color: inherit; text-decoration: none;">
  <h2>Testing</h2>
</a>
<p>This library aims to achieve 100% code test coverage.</p>
<pre><code class="language-sh"><span class="hl-0">npm install</span><br/><span class="hl-0">npm </span><span class="hl-4">test</span>
</code></pre>

<a href="#contributing" id="contributing" style="color: inherit; text-decoration: none;">
  <h2>Contributing</h2>
</a>
<p>We&#39;d love you to join our network of contributors. Please read <a href="CONTRIBUTING.md">CONTRIBUTING.md</a> for help getting started.</p>

<a href="#releasing" id="releasing" style="color: inherit; text-decoration: none;">
  <h3>Releasing</h3>
</a>
<ul>
<li>Commit changes, merge PR&#39;s to <code>main</code> branch</li>
<li>Bump <code>version</code> field in <code>package.json</code></li>
<li>Cut a new <a href="https://github.com/truestamp/truestamp-verify/releases">release</a></li>
<li>New release will trigger workflow to build, test, and publish package to <a href="https://github.com/truestamp/truestamp-verify/packages">Github Package Registry</a> and
<a href="https://www.npmjs.com/package/@truestamp/verify">NPM.js</a>.</li>
</ul>

<a href="#code-of-conduct" id="code-of-conduct" style="color: inherit; text-decoration: none;">
  <h2>Code of Conduct</h2>
</a>
<p>We expect all members of the community to respect our <a href="CODE_OF_CONDUCT.md">Code of Conduct</a> at all times.</p>

<a href="#legal" id="legal" style="color: inherit; text-decoration: none;">
  <h2>Legal</h2>
</a>
<p>Copyright © 2022 Truestamp Inc. All Rights Reserved.</p>
</div></div><div class="col-4 col-menu menu-sticky-wrap menu-highlight"><nav class="tsd-navigation primary"><ul><li class="current"><a href="modules.html">Exports</a></li></ul></nav><nav class="tsd-navigation secondary menu-sticky"><ul><li class="tsd-kind-type-alias"><a href="modules.html#Commitment" class="tsd-kind-icon">Commitment</a></li><li class="tsd-kind-type-alias"><a href="modules.html#CommitmentVerification" class="tsd-kind-icon">Commitment<wbr/>Verification</a></li><li class="tsd-kind-type-alias"><a href="modules.html#SignedKey" class="tsd-kind-icon">Signed<wbr/>Key</a></li><li class="tsd-kind-type-alias"><a href="modules.html#SignedKeys" class="tsd-kind-icon">Signed<wbr/>Keys</a></li><li class="tsd-kind-variable"><a href="modules.html#Commitment" class="tsd-kind-icon">Commitment</a></li><li class="tsd-kind-variable"><a href="modules.html#CommitmentVerification" class="tsd-kind-icon">Commitment<wbr/>Verification</a></li><li class="tsd-kind-variable"><a href="modules.html#SignedKey" class="tsd-kind-icon">Signed<wbr/>Key</a></li><li class="tsd-kind-variable"><a href="modules.html#SignedKeys" class="tsd-kind-icon">Signed<wbr/>Keys</a></li><li class="tsd-kind-function"><a href="modules.html#assertVerified" class="tsd-kind-icon">assert<wbr/>Verified</a></li><li class="tsd-kind-function"><a href="modules.html#assertVerifiedUnsafelyOffline" class="tsd-kind-icon">assert<wbr/>Verified<wbr/>Unsafely<wbr/>Offline</a></li><li class="tsd-kind-function"><a href="modules.html#isVerified" class="tsd-kind-icon">is<wbr/>Verified</a></li><li class="tsd-kind-function"><a href="modules.html#isVerifiedUnsafelyOffline" class="tsd-kind-icon">is<wbr/>Verified<wbr/>Unsafely<wbr/>Offline</a></li><li class="tsd-kind-function"><a href="modules.html#verify" class="tsd-kind-icon">verify</a></li><li class="tsd-kind-function"><a href="modules.html#verifyUnsafelyOffline" class="tsd-kind-icon">verify<wbr/>Unsafely<wbr/>Offline</a></li></ul></nav></div></div></div><footer class=""><div class="container"><h2>Settings</h2><p>Theme <select id="theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></p></div></footer><div class="overlay"></div><script src="assets/main.js"></script></body></html>